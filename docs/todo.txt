
app/controllers/application_controller.rb container render 404, 500
In web, improve dialog-box errors, eg when you get a server 500
 this needs to be logged so it is visible in a docker-logs command.

In revert_test.rb instead of 
  @files[filename] = 'Hello'
if you write
  @files[filename] = {'content' => 'Hello'}
then it seems to cause saver to silently drop its incoming call.
There needs to be some pydantic-like checking of the parameters.

Any app-controller tests use RunnerService when they could use RunnerStub?

Are app-controller tests still using v0/v1 manifests?
  Use v2 in all tests.
  Create multi-version-tests? See source/test/test_base.rb v_tests

------------------------------------------------------------------

- Switch to a "dotted index view"
  Eg 6 -> ite(7,8,9) -> 10 
  currently, each index is shown, 7,8,9,10, etc.
  Make the view 6, 6.1(7), 6.2(8), 6.3(9), 7(10), etc.
  Eg   [<] [6.13] [>] 
  With this, switching off details[x] when on 6.2(8) would go back to "plain" 6
  Replace all displays of 'index' with result of function that returns 'index'.
  Then update the function.
  Note the variable size is a good reason to put the navigator with the RAGs.
  Check CSS copes with variable size.
  How will this work for [test] page which appends new traffic-lights?
  Its index is 10, could be displayed as 4
  Need new field, lightIndex which is incremented after [test] or [revert]
  Feels like it might be better for the light/event to be augmented in the controller?
  This would be seen in the tool-tips too.
  This would also need to be implemented on the test and dashboard pages.
  dottedIndex() which is used for tool-tip does not work from the test page
    Could saver.ran_tests2() return a dict? DONE
    { 'next_index' => 19, 'major_index' => 6, 'minor_index' => 3 }
    Where 18 ==> 6.3
  Added that and now using major_index in the main [test] page RAGs 
  Now need to switch to building dotted-index from kata.events(id) DONE

- The diff tool-tip when details[x] now looks too busy.
  A RAG does not need a diff at all!
  And the file-events themeselves can each contains details of the one 
  file they are about. Eg Instead of...
    - + =
        15 = readme.txt
    1 1  7 ! hiker.sh 
         8 = test_hiker.sh
         3 = bats_help.sh
         2 = cyber-dojo.sh 
  
   it can be simply...
    1 1  7 ! hiker.sh 


- In demo, add events for 'faulty' and 'pulling'.
  Check review with details[x] and moving [<][>] across them

- cd.lib.isLight(event) also gives true for create event. Not clear?
  Add cd.lib.isTest(event) and check that also gives true for 
  'faulty' and 'pulling'
  Maybe rename cd.lib.isFileEvent to cd.lib.isMinor(event)?
  Could implement cd.lib.isLight() as !cd.lib.isFileEvent()?

- In avatar-navigator, when [<] [>] is selected, JS code currently
  hard-wires the index to (expression) ? 1 : avatar.events.length - 1;
  This needs to use traffic-light functions.

- In review mode when a RAG is chosen should stdout/stderr be selected?
  If so, how to choose?
  - could look at stdout/stderr and see is either is empty?
  - could use light.colour as a guide?

- Polyfill old checkouts on saver model?
  having index=0 -> colour="create" would be handy.
  adding diff-added/deleted-count in index=0 also

- From demo, if you add a new traffic-lights by hitting [test] 
  these get the correct RAG and diff tool-tip. But if you click it
  then in review mode, when you select one of these new RAGs, 
  with diff[x] on, then you get no diff in the files. You should. 

- Refactor JS so refresh methods are called only when needed.

- Fix layout/CSS for review-mode from dashboard

- Should diff[x] be fixed to on when in details[x] is on?

- Checkout is prevented if it undoes an auto-revert.
  Suppose RAG -> RAG was 6->7->8 where 8 is same as 6
  then you are prevented from checking out 7.
  Suppose RAG -> RAG is now 6 -> ite(7,8,9) -> 10 -> 11 where 11 is same as 6.
  Are you now prevented from checking out 7,8,9,10 ?
  Or should this restriction be turned off completely?

- Sometimes get RAG tool-tip appearing in top-left and not going away.
  Maybe set a timeout of eg 5 seconds so it always goes away?

------------------------------------------------------------------

- pre-release
- switch web to call saver.ran_tests() instead of saver.ran_tests2()      
- comment out JS calls to file-create/delete/rename/edit 
- do careful check that everything still works: 
    [test]-review, [dashboard]-review, revert, checkout, predict, etc
- check for stability, continue testing/checking

- release
  - use saver.ran_tests2()
  - turn on file-create/delete/rename/edit
  - check index numbering in details mode

- post-release
  o) reimplement saver.ran_test() to be the same as saver.ran_tests2()
  o) switch web to call saver.ran_tests()
  o) delete saver.ran_tests2()
