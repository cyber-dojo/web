<div id="traffic-lights-counts">
  <div class="box">
    <img src="/images/traffic-light/red.png">
    <div class="red count">0</div>
  </div>
  <div class="box">
    <img src="/images/traffic-light/amber.png">
    <div class="amber count">0</div>
  </div>
  <div class="box">
    <img src="/images/traffic-light/green.png">
    <div class="green count">0</div>
  </div>
  <div class="timed_out box" style="display:none;">
    <img src="/images/traffic-light/timed_out.png">
    <div class="timed_out count">0</div>
  </div>
  <div class="pulling box" style="display:none;">
    <img src="/images/traffic-light/pulling.png">
    <div class="pulling count">0</div>
  </div>
  <div class="faulty box" style="display:none;">
    <img src="/images/traffic-light/faulty.png">
    <div class="faulty count">0</div>
  </div>
</div>

<script>
'use strict';
$(() => {

  // - - - - - - - - - - - - - - - - - - - - - - - - - - - -
  // cd.kata.updateTrafficLightsCounts() updates the total-counts
  // It is called from these places:
  //   1) views/kata/_edit.html.erb when page loads/refreshes.
  //   2) views/kata/run_tests.js.erb when [test] is clicked.
  //   3) views/review/_review.html.erb when [checkout] is clicked.

  const $counts = $('#traffic-lights-counts');

  cd.kata.updateTrafficLightsCounts = (light) => {
    const colour = light.colour;
    counts[colour] += 1;
    if (counts[colour] > 0) {
      $(`.${colour}.box`).show();
    }
    $('.count', $counts).removeClass('actual');
    $(`.${colour}.count`, $counts).text(counts[colour]).addClass('actual');
  };

  // - - - - - - - - - - - - - - - - - - - - - - - - - - - -
  const counts = {
    red: 0,
    amber: 0,
    green: 0,
    timed_out: 0,
    pulling: 0,
    faulty:0,
  };

});
</script>
